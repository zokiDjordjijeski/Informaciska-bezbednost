# Автентикација

## Опис на проектот
Овој проект е веб-апликација која обезбедува функционалности за регистрација и најава на корисници со автентикација. Апликацијата користи **Node.js**, **Express**, **Sequelize**, и **JWT (JSON Web Tokens)** за управување со корисничките сесии и автентикација. Дополнително, се имплементира **двостепена автентикација (2FA)** како дополнителен слој на безбедност.

Апликацијата поддржува:
- Регистрација на корисници со е-пошта и лозинка.
- Верификација на е-пошта преку токен испратен со **Nodemailer**.
- Најава со двостепена автентикација (2FA) преку код испратен на е-пошта.
- Улоги на корисници (администратор и обичен корисник).
- Управување со улоги преку администраторски панел.


## Упатство за користење

### 1. Инсталација
1. Клонирајте го репозиториумот:
   ```bash
   git clone https://github.com/zokiDjordjijeski/Informaciska-Bezbednost.git
   cd Informaciska-Bezbednost
   ```

2. Инсталирајте ги зависностите:
   ```bash
   npm install
   ```

3. Креирајте `.env` датотека во коренот на проектот и пополнете ги следните вредности:
   ```env
   PORT=3000
   DB_NAME=your_database_name
   DB_USER=your_database_user
   DB_PASS=your_database_password
   DB_HOST=localhost
   DB_DIALECT=mysql
   DB_EMAIL=your_email@example.com
   DB_PASSWORD=your_email_password
   JWT_SECRET=your_jwt_secret
   ```

4. Синхронизирајте ја базата на податоци:
   ```bash
   node server.js
   ```

### 2. Стартување на серверот
За да го стартувате серверот, извршете ја следната команда:
```bash
npm start
```
Серверот ќе биде достапен на `http://localhost:3000`.


## Функционалности

### 1. Регистрација
- Корисникот внесува корисничко име, е-пошта и лозинка.
- Системот верифицира дали е-поштата е валидна и дали веќе постои.
- Испраќа верификациски токен на е-поштата на корисникот.
- Корисникот мора да ја потврди својата е-пошта пред да се најави.

### 2. Најава
- Корисникот внесува е-пошта и лозинка.
- Доколку корисникот е верифициран, системот испраќа 2FA код на е-поштата.
- Корисникот внесува 2FA код за да ја заврши најавата.

### 3. Двостепена автентикација (2FA)
- Кодот за 2FA се генерира динамички и важи 5 минути.
- Испраќањето на кодот се врши преку **Nodemailer**.

### 4. Улоги на корисници
- Корисниците имаат улога `user` или `admin`.
- Администраторите можат да управуваат со улогите на корисниците преку администраторски панел.

### 5. Управување со улоги
- Администраторите можат да ги менуваат улогите на корисниците преку dropdown мени во администраторскиот панел.


## Структура на проектот

### Фолдери и датотеки
- `server.js`: Главниот серверски фајл кој ги дефинира рутите и функционалностите.
- `views/`: Содржи HTML и EJS шаблони за фронт-енд.
  - `Register.html`: Формулар за регистрација.
  - `Login.html`: Формулар за најава.
  - `2FA.html`: Формулар за внесување на 2FA код.
  - `Home.html`: Почетна страна за корисниците.
  - `view.ejs`: Администраторски панел за управување со корисници.
- `package.json`: Конфигурација на проектот и зависности.
- `.env`: Чувствителни податоци за конфигурација (не е вклучена во репозиториумот).
- `public/`: Содржи статички датотеки како CSS.


## Технологии
- **Node.js**: Серверска страна.
- **Express**: Рамка за веб-апликации.
- **Sequelize**: ORM за работа со бази на податоци.
- **MySQL**: Релациона база на податоци.
- **Nodemailer**: Испраќање е-пошта.
- **JWT (JSON Web Tokens)**: Управување со сесии.
- **bcrypt**: Хаширање на лозинки.



## База на податоци
### Табела: `profil`
| Поле                     | Тип        | Опис                              |
|---------------------------|------------|------------------------------------|
| `username`               | STRING     | Корисничко име                    |
| `email`                  | STRING     | Е-пошта                           |
| `password`               | STRING     | Хаширана лозинка                  |
| `salt`                   | STRING     | Случаен стринг за хаширање        |
| `IsVerified`             | BOOLEAN    | Дали е-поштата е верифицирана     |
| `verificationRegisterCode` | STRING     | Токен за верификација             |
| `codeRegisterExpires`    | DATE       | Време на истекување на токенот    |
| `verificationLoginCode`  | STRING     | Код за 2FA                        |
| `codeLoginExpires`       | DATE       | Време на истекување на 2FA кодот  |
| `role`                   | STRING     | Улога (`user` или `admin`)        |

